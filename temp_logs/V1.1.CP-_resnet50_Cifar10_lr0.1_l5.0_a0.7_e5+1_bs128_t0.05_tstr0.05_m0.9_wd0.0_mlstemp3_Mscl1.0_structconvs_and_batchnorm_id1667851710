V1.1.CP-_resnet50_Cifar10_lr0.1_l5.0_a0.7_e5+1_bs128_t0.05_tstr0.05_m0.9_wd0.0_mlstemp3_Mscl1.0_structconvs_and_batchnorm_id1667851710
Files already downloaded and verified
M values:
 {0: 0.5254763960838318, 1: 0.24196940660476685, 2: 0.16776403784751892, 3: 0.16238752007484436, 4: 0.3461485505104065, 5: 0.2161065936088562, 6: 0.21617008745670319, 7: 0.14946585893630981, 8: 0.12315308302640915, 9: 0.2126564234495163, 10: 0.21397365629673004, 11: 0.14114058017730713, 12: 0.2938171923160553, 13: 0.20867837965488434, 14: 0.2057635486125946, 15: 0.24919012188911438, 16: 0.22829987108707428, 17: 0.2266186624765396, 18: 0.14851202070713043, 19: 0.1509608030319214, 20: 0.1507171094417572, 21: 0.11626473814249039, 22: 0.14856715500354767, 23: 0.13200514018535614, 24: 0.21676331758499146, 25: 0.19993089139461517, 26: 0.1809844970703125, 27: 0.21407803893089294, 28: 0.1508088856935501, 29: 0.14560416340827942, 30: 0.21709460020065308, 31: 0.12570373713970184, 32: 0.13738781213760376, 33: 0.12841346859931946, 34: 0.10435449331998825, 35: 0.12960872054100037, 36: 0.11344355344772339, 37: 0.14070460200309753, 38: 0.13000337779521942, 39: 0.13419312238693237, 40: 0.13650989532470703, 41: 0.16622278094291687, 42: 0.1363247036933899, 43: 0.1465432345867157, 44: 0.15357787907123566, 45: 0.20608027279376984, 46: 0.1028725802898407, 47: 0.11043841391801834, 48: 0.13871222734451294, 49: 0.2982226014137268, 50: 0.10624862462282181, 51: 0.17760427296161652, 52: 0.3519378900527954}
current lr 1.00000e-01
Grad=  tensor(9311.7734, device='cuda:0')
Epoch: [0][0/391]	Time 2.361 (2.361)	Data 0.168 (0.168)	Loss 10.4954 (10.4954) ([4.678]+[5.817])	Prec@1 0.000 (0.000)
Epoch: [0][100/391]	Time 0.105 (0.127)	Data 0.000 (0.002)	Loss 10.2233 (12.3917) ([2.416]+[7.808])	Prec@1 15.625 (10.651)
Epoch: [0][200/391]	Time 0.105 (0.116)	Data 0.000 (0.001)	Loss 9.2568 (11.0817) ([2.144]+[7.113])	Prec@1 13.281 (12.729)
Epoch: [0][300/391]	Time 0.105 (0.112)	Data 0.000 (0.001)	Loss 8.5211 (10.3689) ([1.985]+[6.536])	Prec@1 28.125 (14.883)
Test: [49/79]	Time 0.040 (0.042)	Loss 8.0313 (8.0807) ([1.936]+[6.095])	Prec@1 25.781 (23.906)
 * Prec@1 23.990
current lr 1.00000e-01
Grad=  tensor(0.6528, device='cuda:0')
Epoch: [1][0/391]	Time 0.268 (0.268)	Data 0.152 (0.152)	Loss 8.2164 (8.2164) ([2.121]+[6.095])	Prec@1 17.969 (17.969)
Epoch: [1][100/391]	Time 0.104 (0.107)	Data 0.000 (0.002)	Loss 7.6087 (7.8432) ([1.926]+[5.682])	Prec@1 25.000 (25.340)
Epoch: [1][200/391]	Time 0.104 (0.106)	Data 0.000 (0.001)	Loss 7.1665 (7.6242) ([1.833]+[5.334])	Prec@1 32.031 (26.788)
Epoch: [1][300/391]	Time 0.105 (0.106)	Data 0.000 (0.001)	Loss 6.9615 (7.4286) ([1.929]+[5.033])	Prec@1 24.219 (27.912)
Test: [49/79]	Time 0.039 (0.042)	Loss 6.5469 (6.5551) ([1.753]+[4.794])	Prec@1 34.375 (34.297)
 * Prec@1 34.030
current lr 1.00000e-01
Grad=  tensor(0.9230, device='cuda:0')
Epoch: [2][0/391]	Time 0.273 (0.273)	Data 0.160 (0.160)	Loss 6.6677 (6.6677) ([1.873]+[4.794])	Prec@1 31.250 (31.250)
Epoch: [2][100/391]	Time 0.105 (0.107)	Data 0.000 (0.002)	Loss 6.2386 (6.4474) ([1.673]+[4.566])	Prec@1 36.719 (33.261)
Epoch: [2][200/391]	Time 0.105 (0.106)	Data 0.000 (0.001)	Loss 6.0599 (6.3066) ([1.695]+[4.365])	Prec@1 34.375 (34.511)
Epoch: [2][300/391]	Time 0.105 (0.106)	Data 0.000 (0.001)	Loss 5.8585 (6.1918) ([1.670]+[4.189])	Prec@1 38.281 (35.382)
Test: [49/79]	Time 0.039 (0.042)	Loss 5.7210 (5.7719) ([1.676]+[4.045])	Prec@1 46.875 (37.484)
 * Prec@1 36.660
current lr 1.00000e-01
Grad=  tensor(0.7606, device='cuda:0')
Epoch: [3][0/391]	Time 0.264 (0.264)	Data 0.150 (0.150)	Loss 5.5952 (5.5952) ([1.550]+[4.045])	Prec@1 36.719 (36.719)
Epoch: [3][100/391]	Time 0.105 (0.107)	Data 0.000 (0.002)	Loss 5.5013 (5.5661) ([1.647]+[3.854])	Prec@1 40.625 (39.403)
Epoch: [3][200/391]	Time 0.105 (0.106)	Data 0.000 (0.001)	Loss 5.1407 (5.4436) ([1.526]+[3.615])	Prec@1 46.094 (40.201)
Epoch: [3][300/391]	Time 0.105 (0.106)	Data 0.000 (0.001)	Loss 4.9536 (5.2985) ([1.620]+[3.333])	Prec@1 39.844 (41.079)
Test: [49/79]	Time 0.039 (0.042)	Loss 4.6050 (4.6854) ([1.416]+[3.188])	Prec@1 46.094 (44.641)
 * Prec@1 44.850
current lr 1.00000e-01
Grad=  tensor(0.7259, device='cuda:0')
Epoch: [4][0/391]	Time 0.264 (0.264)	Data 0.151 (0.151)	Loss 4.7428 (4.7428) ([1.554]+[3.188])	Prec@1 42.969 (42.969)
Epoch: [4][100/391]	Time 0.106 (0.107)	Data 0.000 (0.002)	Loss 4.5884 (4.6172) ([1.491]+[3.098])	Prec@1 47.656 (45.073)
Epoch: [4][200/391]	Time 0.105 (0.106)	Data 0.000 (0.001)	Loss 4.3749 (4.5425) ([1.390]+[2.984])	Prec@1 52.344 (46.055)
Epoch: [4][300/391]	Time 0.105 (0.105)	Data 0.000 (0.001)	Loss 4.2508 (4.4829) ([1.345]+[2.906])	Prec@1 52.344 (46.711)
Test: [49/79]	Time 0.039 (0.042)	Loss 4.2119 (4.2933) ([1.371]+[2.841])	Prec@1 45.312 (48.812)
 * Prec@1 48.750

 Elapsed time for training  0:03:45.586244
Total parameter pruned without thresholding: 0.0 (unstructured) 0 (structured)
UNSTRUCT THRESHOLDING
original accuracy
 * Prec@1 48.790
 * Prec@1 48.790
current threshold  0.05
 * Prec@1 17.624
current threshold  0.025
 * Prec@1 11.498
current threshold  0.0125
 * Prec@1 14.858
current threshold  0.00625
 * Prec@1 43.408
current threshold  0.003125
 * Prec@1 48.732
current threshold  0.0015625
 * Prec@1 48.868
current threshold  0.0023437500000000003
 * Prec@1 48.860
current threshold  0.0027343750000000003
 * Prec@1 48.806
current threshold  0.0029296875
 * Prec@1 48.824
current threshold  0.00302734375
 * Prec@1 48.780
Final unstruct threshold  0.00302734375
 * Prec@1 48.780

 Total parameter pruned after unstruct thresholding: 10584178.021642953 (unstructured) 5806080 (structured)

Test: [49/79]	Time 0.039 (0.043)	Loss 4.1714 (4.4187) ([1.348]+[2.824])	Prec@1 46.094 (49.141)
 * Prec@1 48.990
STRUCT THRESHOLDING
original accuracy
 * Prec@1 48.780
 * Prec@1 48.780
current threshold  0.05
 * Prec@1 34.124
resuming
 * Prec@1 34.124
current threshold  0.025
 * Prec@1 34.124
resuming
 * Prec@1 34.124
current threshold  0.0125
 * Prec@1 34.124
resuming
 * Prec@1 34.124
current threshold  0.00625
 * Prec@1 34.124
resuming
 * Prec@1 34.124
current threshold  0.003125
 * Prec@1 34.124
resuming
 * Prec@1 34.124
current threshold  0.0015625
 * Prec@1 34.124
resuming
 * Prec@1 34.124
current threshold  0.00078125
 * Prec@1 34.124
resuming
 * Prec@1 34.124
current threshold  0.000390625
 * Prec@1 34.124
resuming
 * Prec@1 34.124
current threshold  0.0001953125
 * Prec@1 34.124
resuming
 * Prec@1 34.124
current threshold  9.765625e-05
 * Prec@1 34.124
resuming
 * Prec@1 34.124
Final struct threshold  0
 * Prec@1 34.124

 Total parameter pruned after struct thresholding: 10584178.021642953 (unstructured) 5806080 (structured)

Test: [49/79]	Time 0.040 (0.043)	Loss 11.5951 (11.0089) ([8.792]+[2.803])	Prec@1 35.156 (33.547)
 * Prec@1 33.800

 Total elapsed time  0:08:55.745487 
 FINETUNING

current lr 1.00000e-01
Grad=  tensor(1.2942, device='cuda:0')
Epoch: [5][0/391]	Time 0.216 (0.216)	Data 0.153 (0.153)	Loss 1.5808 (1.5808) ([1.581]+[0.000])	Prec@1 44.531 (44.531)
Epoch: [5][100/391]	Time 0.055 (0.056)	Data 0.000 (0.002)	Loss 1.3240 (1.3543) ([1.324]+[0.000])	Prec@1 44.531 (50.580)
Epoch: [5][200/391]	Time 0.055 (0.055)	Data 0.000 (0.001)	Loss 1.1852 (1.3263) ([1.185]+[0.000])	Prec@1 53.125 (51.555)
Epoch: [5][300/391]	Time 0.055 (0.055)	Data 0.000 (0.001)	Loss 1.1831 (1.3002) ([1.183]+[0.000])	Prec@1 54.688 (52.479)
Test: [49/79]	Time 0.018 (0.021)	Loss 1.1533 (1.2265) ([1.153]+[0.000])	Prec@1 60.156 (57.375)
 * Prec@1 56.610

 Elapsed time for training  0:09:19.031507
Total parameter pruned: 6497280.0 (unstructured) 6497280 (structured)
Test: [49/79]	Time 0.018 (0.022)	Loss 1.1533 (1.2265) ([1.153]+[0.000])	Prec@1 60.156 (57.375)
 * Prec@1 56.610
Best accuracy:  56.61
Traceback (most recent call last):
  File "/local1/caccmatt/Pruning_prj/grid_search.py", line 191, in <module>
    main()
  File "/local1/caccmatt/Pruning_prj/grid_search.py", line 188, in main
    grid_search.run()
  File "/local1/caccmatt/Pruning_prj/grid_search.py", line 152, in run
    model_pruned=torch.nn.DataParallel(resnet_pruned.__dict__[arch](num_classes))
KeyError: 'resnet50'
