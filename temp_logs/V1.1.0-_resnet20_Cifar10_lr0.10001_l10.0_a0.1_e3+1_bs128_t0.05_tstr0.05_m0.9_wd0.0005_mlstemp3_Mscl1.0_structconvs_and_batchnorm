V1.1.0-_resnet20_Cifar10_lr0.10001_l10.0_a0.1_e3+1_bs128_t0.05_tstr0.05_m0.9_wd0.0005_mlstemp3_Mscl1.0_structconvs_and_batchnorm
Files already downloaded and verified
M values:
 {0: 1.6352988481521606, 1: 1.169867753982544, 2: 0.9106662273406982, 3: 1.2466709613800049, 4: 0.6928866505622864, 5: 0.9905681610107422, 6: 0.9305789470672607, 7: 0.9705817699432373, 8: 0.895604133605957, 9: 0.8712202906608582, 10: 0.8085764646530151, 11: 0.942848265171051, 12: 0.7068805694580078, 13: 0.8874967098236084, 14: 1.2306768894195557, 15: 0.8342021703720093, 16: 1.0810145139694214, 17: 0.9741626381874084, 18: 2.1248533725738525}
current lr 1.00010e-01
Grad=  tensor(29.7616, device='cuda:0')
Epoch: [0][0/391]	Time 1.825 (1.825)	Data 0.162 (0.162)	Loss 38.7195 (38.7195) ([3.108]+[35.611])	Prec@1 12.500 (12.500)
Epoch: [0][100/391]	Time 0.082 (0.083)	Data 0.000 (0.002)	Loss 4.0436 (14.1414) ([1.875]+[2.169])	Prec@1 26.562 (25.232)
Epoch: [0][200/391]	Time 0.064 (0.075)	Data 0.000 (0.001)	Loss 3.0133 (8.6853) ([1.930]+[1.083])	Prec@1 30.469 (27.861)
Epoch: [0][300/391]	Time 0.064 (0.071)	Data 0.000 (0.001)	Loss 2.4107 (6.6421) ([1.844]+[0.567])	Prec@1 23.438 (27.964)
Test: [49/79]	Time 0.023 (0.025)	Loss 3.1702 (3.3364) ([2.653]+[0.517])	Prec@1 17.188 (18.688)
 * Prec@1 18.480
current lr 1.00010e-01
Grad=  tensor(1.6659, device='cuda:0')
Epoch: [1][0/391]	Time 0.222 (0.222)	Data 0.144 (0.144)	Loss 2.4240 (2.4240) ([1.907]+[0.517])	Prec@1 27.344 (27.344)
Epoch: [1][100/391]	Time 0.064 (0.065)	Data 0.000 (0.002)	Loss 2.2879 (2.3301) ([1.772]+[0.515])	Prec@1 28.125 (29.749)
Epoch: [1][200/391]	Time 0.064 (0.065)	Data 0.000 (0.001)	Loss 2.3223 (2.3167) ([1.861]+[0.461])	Prec@1 35.938 (30.181)
Epoch: [1][300/391]	Time 0.063 (0.064)	Data 0.000 (0.001)	Loss 2.1908 (2.2998) ([1.750]+[0.441])	Prec@1 28.125 (30.310)
Test: [49/79]	Time 0.021 (0.024)	Loss 2.3318 (2.3890) ([1.839]+[0.493])	Prec@1 28.906 (26.984)
 * Prec@1 27.370
current lr 1.00010e-01
Grad=  tensor(1.4588, device='cuda:0')
Epoch: [2][0/391]	Time 0.225 (0.225)	Data 0.153 (0.153)	Loss 2.2011 (2.2011) ([1.708]+[0.493])	Prec@1 40.625 (40.625)
Epoch: [2][100/391]	Time 0.064 (0.066)	Data 0.000 (0.002)	Loss 2.0511 (2.2327) ([1.610]+[0.441])	Prec@1 35.156 (32.201)
Epoch: [2][200/391]	Time 0.064 (0.065)	Data 0.000 (0.001)	Loss 2.3146 (2.2461) ([1.842]+[0.472])	Prec@1 27.344 (31.639)
Epoch: [2][300/391]	Time 0.064 (0.065)	Data 0.000 (0.001)	Loss 2.2974 (2.2344) ([1.838]+[0.459])	Prec@1 32.031 (31.741)
Test: [49/79]	Time 0.022 (0.024)	Loss 2.1813 (2.2797) ([1.729]+[0.452])	Prec@1 32.812 (31.016)
 * Prec@1 31.390

 Elapsed time for training  0:01:23.509015
Total parameter pruned without thresholding: 0.0 (unstructured) 0 (structured)
UNSTRUCT THRESHOLDING
original accuracy
 * Prec@1 31.274
 * Prec@1 31.274
current threshold  0.05
 * Prec@1 32.792
current threshold  0.07500000000000001
 * Prec@1 28.744
current threshold  0.0625
 * Prec@1 30.314
current threshold  0.05625
 * Prec@1 31.328
current threshold  0.059375
 * Prec@1 30.984
current threshold  0.0578125
 * Prec@1 31.052
current threshold  0.057031250000000006
 * Prec@1 30.992
current threshold  0.056640625
 * Prec@1 31.362
current threshold  0.0568359375
 * Prec@1 31.002
current threshold  0.05673828125
 * Prec@1 31.008
Final unstruct threshold  0.056640625
 * Prec@1 31.362

 Total parameter pruned after unstruct thresholding: 267109.0000354573 (unstructured) 264294 (structured)

Test: [49/79]	Time 0.023 (0.026)	Loss 2.0203 (2.1166) ([1.777]+[0.243])	Prec@1 30.469 (31.594)
 * Prec@1 31.770
STRUCT THRESHOLDING
original accuracy
 * Prec@1 31.362
 * Prec@1 31.362
current threshold  0.05
 * Prec@1 18.656
current threshold  0.025
 * Prec@1 18.656
current threshold  0.0125
 * Prec@1 18.656
current threshold  0.00625
 * Prec@1 18.656
current threshold  0.003125
 * Prec@1 18.656
current threshold  0.0015625
 * Prec@1 18.656
current threshold  0.00078125
 * Prec@1 18.656
current threshold  0.000390625
 * Prec@1 18.656
current threshold  0.0001953125
 * Prec@1 18.656
current threshold  9.765625e-05
 * Prec@1 18.656
Final struct threshold  0
 * Prec@1 18.656

 Total parameter pruned after struct thresholding: 267109.0000354573 (unstructured) 264294 (structured)

Test: [49/79]	Time 0.024 (0.026)	Loss 2.7140 (2.8510) ([2.532]+[0.182])	Prec@1 16.406 (18.828)
 * Prec@1 18.880

 Total elapsed time  0:02:57.050526 
 FINETUNING

current lr 1.00010e-01
Grad=  tensor(1.7955, device='cuda:0')
Epoch: [3][0/391]	Time 0.195 (0.195)	Data 0.152 (0.152)	Loss 1.9593 (1.9593) ([1.959]+[0.000])	Prec@1 29.688 (29.688)
Epoch: [3][100/391]	Time 0.028 (0.030)	Data 0.000 (0.002)	Loss 1.7777 (1.7519) ([1.778]+[0.000])	Prec@1 32.812 (32.526)
Epoch: [3][200/391]	Time 0.028 (0.029)	Data 0.000 (0.001)	Loss 1.7663 (1.7285) ([1.766]+[0.000])	Prec@1 32.812 (33.458)
Epoch: [3][300/391]	Time 0.028 (0.029)	Data 0.000 (0.001)	Loss 1.6310 (1.7110) ([1.631]+[0.000])	Prec@1 32.031 (33.918)
Test: [49/79]	Time 0.008 (0.011)	Loss 1.7956 (1.8739) ([1.796]+[0.000])	Prec@1 34.375 (29.938)
 * Prec@1 29.880

 Elapsed time for training  0:03:09.128156
Total parameter pruned: 265734.0 (unstructured) 265734 (structured)
Test: [49/79]	Time 0.008 (0.011)	Loss 1.7956 (1.8739) ([1.796]+[0.000])	Prec@1 34.375 (29.938)
 * Prec@1 29.880
Best accuracy:  29.88
Traceback (most recent call last):
  File "/local1/caccmatt/Pruning_prj/grid_search.py", line 182, in <module>
    main()
  File "/local1/caccmatt/Pruning_prj/grid_search.py", line 179, in main
    grid_search.run()
  File "/local1/caccmatt/Pruning_prj/grid_search.py", line 160, in run
    trainer_pr.validate(reg_on = False)
  File "/local1/caccmatt/Pruning_prj/trainer.py", line 259, in validate
    output = self.model(input_var)
  File "/home/x86_64-unknown-linux_ol8-gnu/anaconda-2022.10/envs/pytorch-1.12.1/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/x86_64-unknown-linux_ol8-gnu/anaconda-2022.10/envs/pytorch-1.12.1/lib/python3.9/site-packages/torch/nn/parallel/data_parallel.py", line 166, in forward
    return self.module(*inputs[0], **kwargs[0])
  File "/home/x86_64-unknown-linux_ol8-gnu/anaconda-2022.10/envs/pytorch-1.12.1/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/local1/caccmatt/Pruning_prj/resnet_pruned.py", line 161, in forward
    out = self.layer3(out)
  File "/home/x86_64-unknown-linux_ol8-gnu/anaconda-2022.10/envs/pytorch-1.12.1/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/x86_64-unknown-linux_ol8-gnu/anaconda-2022.10/envs/pytorch-1.12.1/lib/python3.9/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/x86_64-unknown-linux_ol8-gnu/anaconda-2022.10/envs/pytorch-1.12.1/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/local1/caccmatt/Pruning_prj/resnet_pruned.py", line 90, in forward
    out=self.incompatible_sum(skip_x,out)
  File "/local1/caccmatt/Pruning_prj/resnet_pruned.py", line 127, in incompatible_sum
    t_aux[:,final_idxs_skip_x,:]=skip_x[:,shortcut_only_unpruned,:]
RuntimeError: CUDA error: device-side assert triggered
